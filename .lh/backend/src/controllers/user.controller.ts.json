{
    "sourceFile": "backend/src/controllers/user.controller.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 8,
            "patches": [
                {
                    "date": 1762534713765,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762534983585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,67 @@\n+import { Request, Response } from 'express'\r\n+import userModel from '../models/user.model'\r\n+import { User } from '../types/user'\r\n+\r\n+/**\r\n+ * Sign up (add user)\r\n+ * \r\n+ * @route POST /signup\r\n+ * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Respond with success/fail.\r\n+ */\r\n+const addUser = async(req:Request<{},{},Omit<User, 'id'>>, res:Response)=>{\r\n+    const { username, password, firstname, lastname} = req.body\r\n+    if(!username.trim()||!password.trim()||!firstname.trim()||!lastname.trim()){\r\n+        res.status(500).json({\r\n+            message:\"Missing necessary inputs\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    const isSuccess:boolean = await userModel.create({username, password, firstname, lastname})\r\n+\r\n+    if(!isSuccess){\r\n+        res.status(409).json({\r\n+            message: \"Username is taken\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    res.status(201).json({\r\n+        message:\"User successfully added!\"\r\n+    })\r\n+}\r\n+\r\n+/**\r\n+ * Get user by username\r\n+ * \r\n+ * @route GET /check-auth\r\n+ * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n+ * @param {Response} res\r\n+ * @returns {void} return user info from database based on username\r\n+ */\r\n+\r\n+\r\n+/**\r\n+ * Log out\r\n+ * \r\n+ * @route GET /users/logout\r\n+ * @param {Request} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Clear session cookie.\r\n+ */\r\n+const logout = (req: Request, res: Response) => {\r\n+  if (req.session) {\r\n+    req.session = null // clear the session cookie\r\n+  }\r\n+  res.status(200).json({\r\n+    message: \"Logout successful!\"\r\n+  })\r\n+}\r\n+\r\n+\r\n+export default{\r\n+    addUser,\r\n+    logout\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762535140386,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,14 +36,35 @@\n /**\r\n  * Get user by username\r\n  * \r\n  * @route GET /check-auth\r\n- * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n+ * @param {Request} req\r\n  * @param {Response} res\r\n  * @returns {void} return user info from database based on username\r\n  */\r\n \r\n+const getUserByUsername = (req: Request, res: Response) => {\r\n+  if (!req.session || !req.session.username) {\r\n+    res.status(401).json({\r\n+      message: \"Only logged-in users can access this page!\"\r\n+    })\r\n+    return\r\n+  }\r\n+  //get username from cookie-session\r\n+  const { username } = req.session\r\n+  const user = userModel.findByUsername(username)\r\n+  if (!user) {\r\n+    res.status(404).json({\r\n+      message: \"User does not exist!\"\r\n+    })\r\n+    return\r\n+  }\r\n+  res.status(200).json({\r\n+    user: user\r\n+  })\r\n+}\r\n \r\n+\r\n /**\r\n  * Log out\r\n  * \r\n  * @route GET /users/logout\r\n@@ -63,40 +84,5 @@\n \r\n export default{\r\n     addUser,\r\n     logout\r\n-}\n-import { Request, Response } from 'express'\r\n-import userModel from '../models/user.model'\r\n-import { User } from '../types/user'\r\n-\r\n-/**\r\n- * Sign up (add user)\r\n- * \r\n- * @route POST /users/signup\r\n- * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n- * @param {Response} res\r\n- * @returns {void} Respond with success/fail.\r\n- */\r\n-const signup = async(req:Request<{},{},Omit<User, 'id'>>, res:Response){\r\n-    const { username, password, firstname, lastname} = req.body\r\n-    if(!username.trim()||!password.trim()||!firstname.trim()||!lastname.trim()){\r\n-        res.status(500).json({\r\n-            message:\"Missing necessary inputs\"\r\n-        })\r\n-        return\r\n-    }\r\n-\r\n-    const isSuccess:boolean = await userModel.create({username, password, firstname, lastname})\r\n-\r\n-    if(!isSuccess){\r\n-        res.status(409).json({\r\n-            message: \"Username is taken\"\r\n-        })\r\n-        return\r\n-    }\r\n-\r\n-    res.status(201).json({\r\n-        message:\"User successfully added!\"\r\n-    })\r\n-\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762535479731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n \r\n /**\r\n  * Sign up (add user)\r\n  * \r\n- * @route POST /signup\r\n+ * @route POST user/signup\r\n  * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n  * @param {Response} res\r\n  * @returns {void} Respond with success/fail.\r\n  */\r\n@@ -32,12 +32,48 @@\n         message:\"User successfully added!\"\r\n     })\r\n }\r\n \r\n+\r\n /**\r\n+ * Log in \r\n+ * \r\n+ * @route POST user/login\r\n+ * @param {Request<{}, {}, Partial<User>>} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Respond with success/fail.\r\n+ */\r\n+const loginUser=async(req:Request<{}, {}, Partial<User>>, res:Response)=>{\r\n+    const {username, password} = req.body\r\n+\r\n+    if(!username?.trim()||!password?.trim()){\r\n+        res.status(500).json({\r\n+            message:\"Username or password is empty!\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    const user = await userModel.login({username,password})\r\n+\r\n+    if(!user){\r\n+        res.status(500).json({\r\n+            message:\"Incorect login detail\"\r\n+        })\r\n+        return\r\n+    }\r\n+    if(req.session){\r\n+        req.session.isLoggedIn = true\r\n+        req.session.username = user.username\r\n+    }\r\n+    res.status(200).json({\r\n+        message:\"Login successfully done\"\r\n+    })\r\n+}\r\n+\r\n+/**\r\n  * Get user by username\r\n  * \r\n- * @route GET /check-auth\r\n+ * @route GET user/check-auth\r\n  * @param {Request} req\r\n  * @param {Response} res\r\n  * @returns {void} return user info from database based on username\r\n  */\r\n"
                },
                {
                    "date": 1762535503419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -119,6 +119,8 @@\n \r\n \r\n export default{\r\n     addUser,\r\n-    logout\r\n+    logout,\r\n+    getUserByUsername,\r\n+    loginUser\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762571913113,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,127 @@\n+import { Request, Response } from 'express'\r\n+import userModel from '../models/user.model'\r\n+import { User } from '../types/user'\r\n+\r\n+/**\r\n+ * Sign up (add user)\r\n+ * \r\n+ * @route POST user/signup\r\n+ * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Respond with success/fail.\r\n+ */\r\n+const addUser = async(req:Request<{},{},Omit<User, 'id'>>, res:Response)=>{\r\n+    const { username, password, firstname, lastname} = req.body\r\n+    if(!username.trim()||!password.trim()||!firstname.trim()||!lastname.trim()){\r\n+        res.status(500).json({\r\n+            message:\"Missing necessary inputs\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    const isSuccess:boolean = await userModel.create({username, password, firstname, lastname})\r\n+\r\n+    if(!isSuccess){\r\n+        res.status(409).json({\r\n+            message: \"Username is taken\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    res.status(201).json({\r\n+        message:\"User successfully added!\"\r\n+    })\r\n+}\r\n+\r\n+\r\n+/**\r\n+ * Log in \r\n+ * \r\n+ * @route POST user/login\r\n+ * @param {Request<{}, {}, Partial<User>>} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Respond with success/fail.\r\n+ */\r\n+const loginUser=async(req:Request<{}, {}, Partial<User>>, res:Response)=>{\r\n+    const {username, password} = req.body\r\n+\r\n+    if(!username?.trim()||!password?.trim()){\r\n+        res.status(500).json({\r\n+            message:\"Username or password is empty!\"\r\n+        })\r\n+        return\r\n+    }\r\n+\r\n+    const user = await userModel.login({username,password})\r\n+\r\n+    if(!user){\r\n+        res.status(500).json({\r\n+            message:\"Incorect login detail\"\r\n+        })\r\n+        return\r\n+    }\r\n+    if(req.session){\r\n+        req.session.isLoggedIn = true\r\n+        req.session.username = user.username\r\n+    }\r\n+    res.status(200).json({\r\n+        message:\"Login successfully done\"\r\n+    })\r\n+}\r\n+\r\n+/**\r\n+ * Get user by username\r\n+ * \r\n+ * @route GET user/check-auth\r\n+ * @param {Request} req\r\n+ * @param {Response} res\r\n+ * @returns {void} return user info from database based on username\r\n+ */\r\n+\r\n+const getUserByUsername = (req: Request, res: Response) => {\r\n+  if (!req.session || !req.session.username) {\r\n+    console.log(req.session)\r\n+    res.status(401).json({\r\n+      message: \"Only logged-in users can access this page!\"\r\n+    })\r\n+    return\r\n+  }\r\n+  //get username from cookie-session\r\n+  const { username } = req.session\r\n+  const user = userModel.findByUsername(username)\r\n+  if (!user) {\r\n+    res.status(404).json({\r\n+      message: \"User does not exist!\"\r\n+    })\r\n+    return\r\n+  }\r\n+  res.status(200).json({\r\n+    user: user\r\n+  })\r\n+}\r\n+\r\n+\r\n+/**\r\n+ * Log out\r\n+ * \r\n+ * @route GET /users/logout\r\n+ * @param {Request} req\r\n+ * @param {Response} res\r\n+ * @returns {void} Clear session cookie.\r\n+ */\r\n+const logout = (req: Request, res: Response) => {\r\n+  if (req.session) {\r\n+    req.session = null // clear the session cookie\r\n+  }\r\n+  res.status(200).json({\r\n+    message: \"Logout successful!\"\r\n+  })\r\n+}\r\n+\r\n+\r\n+export default{\r\n+    addUser,\r\n+    logout,\r\n+    getUserByUsername,\r\n+    loginUser\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762572373786,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,8 +59,9 @@\n             message:\"Incorect login detail\"\r\n         })\r\n         return\r\n     }\r\n+    console.log(req.session)\r\n     if(req.session){\r\n         req.session.isLoggedIn = true\r\n         req.session.username = user.username\r\n     }\r\n@@ -123,131 +124,5 @@\n     addUser,\r\n     logout,\r\n     getUserByUsername,\r\n     loginUser\r\n-}\n-import { Request, Response } from 'express'\r\n-import userModel from '../models/user.model'\r\n-import { User } from '../types/user'\r\n-\r\n-/**\r\n- * Sign up (add user)\r\n- * \r\n- * @route POST user/signup\r\n- * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n- * @param {Response} res\r\n- * @returns {void} Respond with success/fail.\r\n- */\r\n-const addUser = async(req:Request<{},{},Omit<User, 'id'>>, res:Response)=>{\r\n-    const { username, password, firstname, lastname} = req.body\r\n-    if(!username.trim()||!password.trim()||!firstname.trim()||!lastname.trim()){\r\n-        res.status(500).json({\r\n-            message:\"Missing necessary inputs\"\r\n-        })\r\n-        return\r\n-    }\r\n-\r\n-    const isSuccess:boolean = await userModel.create({username, password, firstname, lastname})\r\n-\r\n-    if(!isSuccess){\r\n-        res.status(409).json({\r\n-            message: \"Username is taken\"\r\n-        })\r\n-        return\r\n-    }\r\n-\r\n-    res.status(201).json({\r\n-        message:\"User successfully added!\"\r\n-    })\r\n-}\r\n-\r\n-\r\n-/**\r\n- * Log in \r\n- * \r\n- * @route POST user/login\r\n- * @param {Request<{}, {}, Partial<User>>} req\r\n- * @param {Response} res\r\n- * @returns {void} Respond with success/fail.\r\n- */\r\n-const loginUser=async(req:Request<{}, {}, Partial<User>>, res:Response)=>{\r\n-    const {username, password} = req.body\r\n-\r\n-    if(!username?.trim()||!password?.trim()){\r\n-        res.status(500).json({\r\n-            message:\"Username or password is empty!\"\r\n-        })\r\n-        return\r\n-    }\r\n-\r\n-    const user = await userModel.login({username,password})\r\n-\r\n-    if(!user){\r\n-        res.status(500).json({\r\n-            message:\"Incorect login detail\"\r\n-        })\r\n-        return\r\n-    }\r\n-    if(req.session){\r\n-        req.session.isLoggedIn = true\r\n-        req.session.username = user.username\r\n-    }\r\n-    res.status(200).json({\r\n-        message:\"Login successfully done\"\r\n-    })\r\n-}\r\n-\r\n-/**\r\n- * Get user by username\r\n- * \r\n- * @route GET user/check-auth\r\n- * @param {Request} req\r\n- * @param {Response} res\r\n- * @returns {void} return user info from database based on username\r\n- */\r\n-\r\n-const getUserByUsername = (req: Request, res: Response) => {\r\n-  if (!req.session || !req.session.username) {\r\n-    res.status(401).json({\r\n-      message: \"Only logged-in users can access this page!\"\r\n-    })\r\n-    return\r\n-  }\r\n-  //get username from cookie-session\r\n-  const { username } = req.session\r\n-  const user = userModel.findByUsername(username)\r\n-  if (!user) {\r\n-    res.status(404).json({\r\n-      message: \"User does not exist!\"\r\n-    })\r\n-    return\r\n-  }\r\n-  res.status(200).json({\r\n-    user: user\r\n-  })\r\n-}\r\n-\r\n-\r\n-/**\r\n- * Log out\r\n- * \r\n- * @route GET /users/logout\r\n- * @param {Request} req\r\n- * @param {Response} res\r\n- * @returns {void} Clear session cookie.\r\n- */\r\n-const logout = (req: Request, res: Response) => {\r\n-  if (req.session) {\r\n-    req.session = null // clear the session cookie\r\n-  }\r\n-  res.status(200).json({\r\n-    message: \"Logout successful!\"\r\n-  })\r\n-}\r\n-\r\n-\r\n-export default{\r\n-    addUser,\r\n-    logout,\r\n-    getUserByUsername,\r\n-    loginUser\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1762572382208,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,9 @@\n             message:\"Incorect login detail\"\r\n         })\r\n         return\r\n     }\r\n-    console.log(req.session)\r\n+    console.log(\"session\",req.session)\r\n     if(req.session){\r\n         req.session.isLoggedIn = true\r\n         req.session.username = user.username\r\n     }\r\n"
                },
                {
                    "date": 1762572459942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,8 +64,9 @@\n     if(req.session){\r\n         req.session.isLoggedIn = true\r\n         req.session.username = user.username\r\n     }\r\n+    console.log(\"session\",req.session)\r\n     res.status(200).json({\r\n         message:\"Login successfully done\"\r\n     })\r\n }\r\n"
                }
            ],
            "date": 1762534713765,
            "name": "Commit-0",
            "content": "import { Request, Response } from 'express'\r\nimport userModel from '../models/user.model'\r\nimport { User } from '../types/user'\r\n\r\n/**\r\n * Sign up (add user)\r\n * \r\n * @route POST /users/signup\r\n * @param {Request<{}, {}, Omit<User, 'id'>>} req\r\n * @param {Response} res\r\n * @returns {void} Respond with success/fail.\r\n */\r\nconst signup = async(req:Request<{},{},Omit<User, 'id'>>, res:Response){\r\n    const { username, password, firstname, lastname} = req.body\r\n    if(!username.trim()||!password.trim()||!firstname.trim()||!lastname.trim()){\r\n        res.status(500).json({\r\n            message:\"Missing necessary inputs\"\r\n        })\r\n        return\r\n    }\r\n\r\n    const isSuccess:boolean = await userModel.create({username, password, firstname, lastname})\r\n\r\n    if(!isSuccess){\r\n        res.status(409).json({\r\n            message: \"Username is taken\"\r\n        })\r\n        return\r\n    }\r\n\r\n    res.status(201).json({\r\n        message:\"User successfully added!\"\r\n    })\r\n\r\n}"
        }
    ]
}